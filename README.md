# Luma iOS 18.5

Luma is a prototype social experience centered around creating short-lived "moments" of resonance. This repository contains an Xcode project with a basic SwiftUI app (`LumaApp.swift`) that displays `ContentView` on launch.

The backend endpoints and flows mirror the original React/FastAPI prototype. An iOS implementation should consume these APIs to recreate the same behaviors.

## Project layout

- `Luma/LumaApp.swift` – Entry point that loads `ContentView`.
- `Luma/ContentView.swift` – Main SwiftUI view listing moments and letting you create or join them.
- `Luma/Services/` – Simple API client, session and event stores, and WebSocket presence service.
- `LumaTests/` and `LumaUITests/` – Example test targets generated by Xcode.
- `Assets.xcassets/` – Image assets used by the app.

## Core backend API

The API is identical to the prototype's FastAPI backend. Highlights include:

- `POST /api/session` – create an anonymous session token.
- CRUD endpoints under `/api/events` for creating and listing moments.
- `WebSocket /ws/presence/{event_id}` – live participant count for events.
- Optional `/api/match` endpoint to retrieve random events.
- Premium endpoints `/api/resonance` and `/api/moodrooms` for resonance links and mood rooms.

## Expected user flow

1. **Launch the app** – call `POST /api/session` on first run and store the returned token.
2. **Browse moments** – display cards returned from `GET /api/events`.
3. **Create a moment** – open a modal, post to `POST /api/events`, and navigate to the new event's room.
4. **Join an energy room** – fetch event details and connect to `/ws/presence/{id}` to show live counts.
5. **Match with others** (optional) – call `/api/match` to get random moments from other sessions.
6. **Premium features** – after login/signup, allow creating resonance links and mood rooms, each with their WebSocket presence channels.

Mood definitions (animations, colors, ambient audio) should be loaded from the `public/moods` directory, matching the web prototype's configuration format.

## Running tests

The project ships with placeholder unit and UI tests in `LumaTests` and `LumaUITests`. These can be executed from Xcode or via `xcodebuild` to validate the app once implemented.

## Offline mock mode

By default the app runs without a backend. `APIClient.useMock` is set to `true`,
causing all API calls and presence updates to return local mock data defined in
`MockData.swift`. Set this flag to `false` when you want to connect to a real
server.

